---
import MainHead from './MainHead.astro';
import { SEO_CONFIG, STRUCTURED_DATA } from '../constants/seo';
import { generateStructuredData } from '../utils/seoHelpers';

export interface Props {
    title?: string;
    description?: string;
    image?: string;
    noindex?: boolean;
    schemaType?: string;
    schemaData?: Record<string, any>;
}

const {
    title = SEO_CONFIG.defaultTitle,
    description = SEO_CONFIG.defaultDescription,
    image = SEO_CONFIG.defaultImage,
    noindex = false,
    schemaType = 'WebApplication',
    schemaData = {}
} = Astro.props;

// Generate structured data
const pageSchema = generateStructuredData(schemaType, {
    name: title,
    description: description,
    ...schemaData
});

// Generate organization schema
const organizationSchema = JSON.stringify(STRUCTURED_DATA.organization, null, 2);
---

<!DOCTYPE html>
<html lang="es">
    <head>
        <MainHead 
            title={title}
            description={description}
            image={image}
            noindex={noindex}
        />
        
        <!-- Structured Data -->
        <script type="application/ld+json" set:html={pageSchema} />
        <script type="application/ld+json" set:html={organizationSchema} />
        
        <!-- Preload critical assets -->
        <link rel="preload" as="image" href="/favicon.svg" type="image/svg+xml" />
    </head>
    <body class="bg-slate-950 min-h-screen">
        <slot />
        
        <!-- Prevent Flash of Unstyled Content -->
        <script>
            document.documentElement.classList.add('js-loaded');
        </script>
    </body>
</html>